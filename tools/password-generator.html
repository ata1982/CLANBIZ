<!-- ツール共通テンプレート -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="まえゆきツールのパスワード生成 - 安全で強力なパスワードを簡単に生成できる無料ツールです。長さや文字の種類をカスタマイズできます。">
  <title>パスワード生成 | まえゆきツール</title>

  <!-- リソースの先読み -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- 共通CSSとフォント -->
  <link rel="stylesheet" href="/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- ツール共通CSS -->
  <link rel="stylesheet" href="/css/tools-common.css">

  <!-- フッターのスタイル -->
  <link rel="stylesheet" href="/css/footer-hover.css">

  <!-- 個別ツールのスタイル -->
  <style>
    /* パスワード生成ツールスタイル */
    .tool-section {
        padding: 80px 0 40px;
        margin-top: var(--header-h);
        background: #f9f3e9;
    }
    .tool-container {
        max-width: 840px;
        margin: 0 auto;
        padding: 0 20px;
    }
    .tool-title {
        font-size: 28px;
        text-align: center;
        margin-bottom: 2rem;
        color: var(--text-dark);
    }
    
    /* パスワード表示エリア */
    .password-display {
        position: relative;
        margin: 30px 0;
    }
    
    .password-field {
        width: 100%;
        padding: 20px;
        font-size: 24px;
        font-family: 'Courier New', monospace;
        text-align: center;
        background: #fff;
        border: 2px solid var(--primary);
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        letter-spacing: 1px;
    }
    
    .copy-btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 4px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 14px;
        display: flex;
        align-items: center;
        transition: background 0.2s;
    }
    
    .copy-btn:hover {
        background: #0052cc;
    }
    
    .copy-btn svg {
        margin-right: 5px;
    }
    
    /* 設定エリア */
    .settings-area {
        background: #fff;
        border-radius: 10px;
        padding: 25px;
        margin-top: 20px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    
    .settings-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 20px;
        padding-bottom: 5px;
        border-bottom: 2px solid #eee;
    }
    
    .setting-row {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        margin-bottom: 15px;
        gap: 20px;
    }
    
    .setting-label {
        font-weight: 500;
        min-width: 150px;
    }
    
    .setting-control {
        flex: 1;
        min-width: 200px;
    }
    
    .range-slider {
        width: 100%;
        height: 5px;
    }
    
    .range-value {
        width: 40px;
        text-align: center;
        margin-left: 10px;
    }
    
    .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
    }
    
    .checkbox-item {
        display: flex;
        align-items: center;
    }
    
    .checkbox-item input {
        margin-right: 8px;
    }
    
    /* 生成ボタン */
    .generate-btn {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        padding: 12px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: 500;
        cursor: pointer;
        margin: 20px 0;
        transition: background 0.2s, transform 0.1s;
    }
    
    .generate-btn:hover {
        background: #0052cc;
    }
    
    .generate-btn:active {
        transform: translateY(2px);
    }
    
    .generate-btn svg {
        margin-right: 8px;
    }
    
    /* パスワード強度メーター */
    .strength-meter {
        margin: 20px 0;
    }
    
    .strength-title {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
    }
    
    .strength-label {
        font-weight: 500;
    }
    
    .strength-text {
        font-weight: 500;
    }
    
    .strength-text.weak { color: #ff3860; }
    .strength-text.fair { color: #ffaf0f; }
    .strength-text.good { color: #17a2b8; }
    .strength-text.strong { color: #23d160; }
    
    .strength-bar {
        height: 6px;
        background: #e9ecef;
        border-radius: 5px;
        overflow: hidden;
    }
    
    .strength-bar-fill {
        height: 100%;
        border-radius: 5px;
        transition: width 0.3s;
    }
    
    .strength-bar-fill.weak { background: #ff3860; width: 25%; }
    .strength-bar-fill.fair { background: #ffaf0f; width: 50%; }
    .strength-bar-fill.good { background: #17a2b8; width: 75%; }
    .strength-bar-fill.strong { background: #23d160; width: 100%; }
    
    /* パスワード履歴 */
    .password-history {
        margin-top: 30px;
    }
    
    .history-title {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 15px;
        padding-bottom: 5px;
        border-bottom: 2px solid #eee;
    }
    
    .history-list {
        max-height: 200px;
        overflow-y: auto;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 5px;
    }
    
    .history-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-bottom: 1px solid #eee;
    }
    
    .history-password {
        font-family: 'Courier New', monospace;
        letter-spacing: 1px;
    }
    
    .history-action {
        color: var(--primary);
        cursor: pointer;
        font-size: 14px;
    }
    
    .history-action:hover {
        text-decoration: underline;
    }
    
    .clear-history {
        color: #e74c3c;
        border: none;
        background: none;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 14px;
        margin-top: 10px;
    }
    
    .clear-history:hover {
        text-decoration: underline;
    }
    
    /* コピー通知 */
    .copy-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #28a745;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        transform: translateX(150%);
        transition: transform 0.3s;
        z-index: 1000;
    }
    
    .copy-notification.show {
        transform: translateX(0);
    }
    
    /* 使い方ボックス */
    .usage-box {
        background: #fff;
        border-radius: 10px;
        padding: 25px;
        margin-top: 40px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    
    .usage-title {
        font-size: 18px;
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        color: var(--text-dark);
    }
    
    .usage-title-icon {
        margin-right: 8px;
        color: var(--primary);
    }
    
    .usage-list {
        padding-left: 20px;
    }
    
    .usage-item {
        margin-bottom: 8px;
        position: relative;
        line-height: 1.5;
    }
    
    .usage-item::before {
        content: "•";
        position: absolute;
        left: -15px;
        color: var(--primary);
    }
    
    /* レスポンシブ対応 */
    @media (max-width: 768px) {
        .setting-row {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }
        
        .setting-label {
            margin-bottom: 5px;
        }
    }
    
    /* ツールページでのフッター調整 */
    .site-footer {
      width: 100%;
      max-width: none;
      margin: 0;
      padding: 40px 20px;
      background-color: #0d3283;
      color: white;
    }
    
    .site-footer .footer-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0;
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      gap: 32px;
    }
    
    .site-footer .footer-widgets {
      display: flex;
      flex: 1;
      flex-wrap: wrap;
      gap: 32px;
    }
    
    .site-footer .widget-area {
      min-width: 160px;
    }
    
    .site-footer .widget-area h4 {
      color: white;
      margin-bottom: 15px;
      font-size: 16px;
      font-weight: bold;
    }
    
    .site-footer .widget-area ul {
      padding: 0;
      list-style: none;
    }
    
    .site-footer .widget-area ul li {
      position: relative;
      margin-bottom: 10px;
    }
    
    .site-footer .widget-area ul li a {
      position: relative;
      display: inline-block;
      color: rgba(255, 255, 255, 0.8);
      font-size: 14px;
      text-decoration: none;
      transition: all 0.15s ease-out;
    }
    
    .site-footer .widget-area ul li a:hover {
      color: white;
    }
    
    @media (max-width: 768px) {
      .site-footer .footer-container {
        flex-direction: column;
        gap: 20px;
      }
      
      .site-footer .footer-widgets {
        flex-direction: column;
        gap: 20px;
      }
    }
  </style>

  <link rel="icon" href="/images/favicon.ico">
  <meta property="og:title" content="パスワード生成 | まえゆきツール">
  <meta property="og:description" content="まえゆきツールのパスワード生成 - 安全で強力なパスワードを簡単に生成できる無料ツールです。長さや文字の種類をカスタマイズできます。">
  <meta property="og:image" content="/images/tool-ogp.webp">
  <meta property="og:type" content="website">
  <!-- インクルード処理 -->
  <script src="/js/include.js"></script>
</head>
<body>
  <!-- ヘッダー -->
  <div id="header-placeholder"></div>

  <!-- メインコンテンツ -->
  <main>
    <!-- ツールセクション -->
    <section class="tool-section">
      <div class="tool-container">
        <div class="tool-header">
          <h1>パスワード生成</h1>
          <p class="tool-description">安全で強力なパスワードを簡単に生成できるツールです。長さや文字の種類をカスタマイズして、好みのパスワードを作成できます。</p>
        </div>
        
        <!-- パスワード表示エリア -->
        <div class="password-display">
          <input type="text" id="passwordOutput" class="password-field" readonly value="パスワード生成ボタンをクリック">
          <button id="copyBtn" class="copy-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            コピー
          </button>
        </div>
        
        <!-- パスワード強度メーター -->
        <div class="strength-meter">
          <div class="strength-title">
            <span class="strength-label">パスワード強度:</span>
            <span id="strengthText" class="strength-text">-</span>
          </div>
          <div class="strength-bar">
            <div id="strengthBar" class="strength-bar-fill"></div>
          </div>
        </div>
        
        <!-- パスワード生成ボタン -->
        <button id="generateBtn" class="generate-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
            <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
            <line x1="6" y1="1" x2="6" y2="4"></line>
            <line x1="10" y1="1" x2="10" y2="4"></line>
            <line x1="14" y1="1" x2="14" y2="4"></line>
          </svg>
          パスワードを生成
        </button>
        
        <!-- 設定エリア -->
        <div class="settings-area">
          <h2 class="settings-title">パスワード設定</h2>
          
          <div class="setting-row">
            <div class="setting-label">パスワードの長さ:</div>
            <div class="setting-control">
              <input type="range" id="lengthSlider" class="range-slider" min="8" max="32" value="16">
              <span id="lengthValue" class="range-value">16</span> 文字
            </div>
          </div>
          
          <div class="setting-row">
            <div class="setting-label">含める文字:</div>
            <div class="setting-control">
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="includeUppercase" checked>
                  <label for="includeUppercase">大文字 (A-Z)</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="includeLowercase" checked>
                  <label for="includeLowercase">小文字 (a-z)</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="includeNumbers" checked>
                  <label for="includeNumbers">数字 (0-9)</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="includeSymbols" checked>
                  <label for="includeSymbols">記号 (!@#$...)</label>
                </div>
              </div>
            </div>
          </div>
          
          <div class="setting-row">
            <div class="setting-label">除外する文字:</div>
            <div class="setting-control">
              <input type="text" id="excludeChars" class="form-control" placeholder="例: 0O1Il">
              <small>視覚的に紛らわしい文字や特定の文字を除外できます</small>
            </div>
          </div>
          
          <div class="setting-row">
            <div class="setting-label">オプション:</div>
            <div class="setting-control">
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="avoidSimilar">
                  <label for="avoidSimilar">視覚的に似た文字を避ける (0O1Il)</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="avoidSequential">
                  <label for="avoidSequential">連続した文字を避ける (123, abc)</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="avoidRepeat">
                  <label for="avoidRepeat">文字の繰り返しを避ける</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- パスワード履歴 -->
        <div class="password-history">
          <h2 class="history-title">生成履歴</h2>
          <div id="historyList" class="history-list">
            <!-- 履歴はJSで動的に生成 -->
            <div id="emptyHistory">生成履歴はありません</div>
          </div>
          <button id="clearHistoryBtn" class="clear-history">履歴をクリア</button>
        </div>
        
        <!-- 使い方ボックス -->
        <div class="usage-box">
          <h3 class="usage-title">
            <span class="usage-title-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
              </svg>
            </span>
            パスワード生成ツールの使い方
          </h3>
          
          <ul class="usage-list">
            <li class="usage-item">「パスワードを生成」ボタンをクリックして、新しいパスワードを作成します。</li>
            <li class="usage-item">設定エリアでパスワードの長さや含める文字を調整できます。</li>
            <li class="usage-item">生成されたパスワードは「コピー」ボタンでクリップボードにコピーできます。</li>
            <li class="usage-item">パスワード強度メーターで、現在のパスワードの強度を確認できます。</li>
            <li class="usage-item">生成したパスワードは履歴に保存され、後から利用することができます。</li>
            <li class="usage-item"><strong>セキュリティ注意:</strong> このツールで生成されたパスワードはあなたのデバイス内でのみ処理され、サーバーには送信されません。</li>
          </ul>
        </div>
        
        <!-- コミュニティCTAセクション -->
        <section class="contact-cta-section">
          <div class="contact-cta-container">
            <span class="contact-cta-subtitle">より便利なツールを一緒に作ろう</span>
            <h2 class="contact-cta-title">ツールリクエスト募集中！</h2>
            <p class="contact-cta-lead">
              こんなツールがあったら便利！というアイデアをお持ちですか？<br class="pc-only">
              まえゆきツールは、みなさんのフィードバックをもとに改善・拡張しています。<br class="pc-only">
              ぜひあなたのアイデアをお聞かせください。
            </p>
            <div class="contact-cta-buttons">               
              <a href="../free-consultation.html" class="btn btn-contact">
                ツールをリクエスト
              </a>
              <a href="../about.html" class="btn btn-document">
                <svg width="14" height="14"><use xlink:href="#icon-pdf"></use></svg>
                サービス詳細
              </a>
            </div>
          </div>
        </section>
        
        <!-- 他のツールリンク -->
        <div class="other-tools">
          <h2 class="other-tools-title">その他のまえゆきツール</h2>
          <div class="tools-list">
            <a href="letters-counter.html" class="tool-link">文字数カウント</a>
            <a href="calc.html" class="tool-link">単位換算と計算</a>
            <a href="countdown.html" class="tool-link">Webでカウントダウン</a>
            <a href="roulette.html" class="tool-link">Webでルーレット</a>
            <a href="bingo.html" class="tool-link">ビンゴ・マシーン</a>
            <a href="image-resize.html" class="tool-link">画像リサイズ</a>
            <a href="png-to-jpeg.html" class="tool-link">PNG→JPEG変換</a>
            <a href="png-jpeg-to-webp.html" class="tool-link">WebP変換</a>
            <a href="wareki-seireki.html" class="tool-link">年齢・和暦計算</a>
            <a href="meme-generator.html" class="tool-link">ミーム作成</a>
            <a href="color-palette.html" class="tool-link">カラーパレット</a>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <!-- コピー通知 -->
  <div id="copyNotification" class="copy-notification">
    パスワードをコピーしました！
  </div>
  
  <!-- フッターを共通コンポーネントとして読み込み -->
  <div id="footer-placeholder"></div>
  
  <!-- SVGアイコン -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="icon-pdf" viewBox="0 0 24 24">
      <path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"/>
    </symbol>
  </svg>

  <!-- 共通JavaScript -->
  <script src="/js/include.js"></script>
  
  <!-- パスワード生成用JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM要素
      const passwordOutput = document.getElementById('passwordOutput');
      const copyBtn = document.getElementById('copyBtn');
      const generateBtn = document.getElementById('generateBtn');
      const lengthSlider = document.getElementById('lengthSlider');
      const lengthValue = document.getElementById('lengthValue');
      const includeUppercase = document.getElementById('includeUppercase');
      const includeLowercase = document.getElementById('includeLowercase');
      const includeNumbers = document.getElementById('includeNumbers');
      const includeSymbols = document.getElementById('includeSymbols');
      const excludeChars = document.getElementById('excludeChars');
      const avoidSimilar = document.getElementById('avoidSimilar');
      const avoidSequential = document.getElementById('avoidSequential');
      const avoidRepeat = document.getElementById('avoidRepeat');
      const strengthText = document.getElementById('strengthText');
      const strengthBar = document.getElementById('strengthBar');
      const historyList = document.getElementById('historyList');
      const emptyHistory = document.getElementById('emptyHistory');
      const clearHistoryBtn = document.getElementById('clearHistoryBtn');
      const copyNotification = document.getElementById('copyNotification');
      
      // 文字セット
      const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const lowercase = 'abcdefghijklmnopqrstuvwxyz';
      const numbers = '0123456789';
      const symbols = '!@#$%^&*()_+~`|}{[]:;?><,./-=';
      const similarChars = '0O1Il';
      
      // イベントリスナー
      generateBtn.addEventListener('click', generatePassword);
      copyBtn.addEventListener('click', copyPassword);
      lengthSlider.addEventListener('input', updateLengthValue);
      clearHistoryBtn.addEventListener('click', clearHistory);
      
      // 保存されたパスワード履歴を読み込む
      loadPasswordHistory();
      
      // パスワード長さ表示を更新
      function updateLengthValue() {
        lengthValue.textContent = lengthSlider.value;
      }
      
      // パスワード生成
      function generatePassword() {
        const length = lengthSlider.value;
        let charset = '';
        let password = '';
        
        // 少なくとも1つのオプションが選択されていることを確認
        if (!includeUppercase.checked && !includeLowercase.checked && 
            !includeNumbers.checked && !includeSymbols.checked) {
          alert('少なくとも1つの文字タイプを含めてください。');
          return;
        }
        
        // 文字セットの構築
        if (includeUppercase.checked) charset += uppercase;
        if (includeLowercase.checked) charset += lowercase;
        if (includeNumbers.checked) charset += numbers;
        if (includeSymbols.checked) charset += symbols;
        
        // 除外文字の処理
        let excludedChars = excludeChars.value;
        
        // 視覚的に似た文字を避ける
        if (avoidSimilar.checked) {
          excludedChars += similarChars;
        }
        
        // 除外文字を文字セットから削除
        for (let i = 0; i < excludedChars.length; i++) {
          charset = charset.replace(excludedChars[i], '');
        }
        
        // 文字セットが空でないことを確認
        if (charset === '') {
          alert('すべての文字が除外されています。設定を確認してください。');
          return;
        }
        
        // パスワードの初期生成
        for (let i = 0; i < length; i++) {
          const randomIndex = Math.floor(Math.random() * charset.length);
          password += charset[randomIndex];
        }
        
        // 連続した文字を避ける処理
        if (avoidSequential.checked) {
          password = avoidSequentialChars(password, charset);
        }
        
        // 繰り返しを避ける処理
        if (avoidRepeat.checked) {
          password = avoidRepeatedChars(password, charset);
        }
        
        // 少なくとも各タイプの文字を1つ含めることを確認
        if (includeUppercase.checked && !/[A-Z]/.test(password)) {
          const index = Math.floor(Math.random() * length);
          password = replaceAt(password, index, getRandomChar(uppercase));
        }
        
        if (includeLowercase.checked && !/[a-z]/.test(password)) {
          const index = Math.floor(Math.random() * length);
          password = replaceAt(password, index, getRandomChar(lowercase));
        }
        
        if (includeNumbers.checked && !/[0-9]/.test(password)) {
          const index = Math.floor(Math.random() * length);
          password = replaceAt(password, index, getRandomChar(numbers));
        }
        
        if (includeSymbols.checked && !/[^A-Za-z0-9]/.test(password)) {
          const index = Math.floor(Math.random() * length);
          password = replaceAt(password, index, getRandomChar(symbols));
        }
        
        passwordOutput.value = password;
        
        // パスワード強度を評価
        evaluatePasswordStrength(password);
        
        // パスワード履歴に追加
        addPasswordToHistory(password);
      }
      
      // パスワードの強度を評価
      function evaluatePasswordStrength(password) {
        let strength = 0;
        const length = password.length;
        
        // 長さによる強度
        if (length >= 8) strength += 1;
        if (length >= 12) strength += 1;
        if (length >= 16) strength += 1;
        if (length >= 20) strength += 1;
        
        // 文字種類による強度
        if (/[A-Z]/.test(password)) strength += 1;
        if (/[a-z]/.test(password)) strength += 1;
        if (/[0-9]/.test(password)) strength += 1;
        if (/[^A-Za-z0-9]/.test(password)) strength += 1;
        
        // エントロピー（複雑さ）による強度
        const uniqueChars = new Set(password).size;
        const entropyRatio = uniqueChars / length;
        if (entropyRatio > 0.7) strength += 2;
        else if (entropyRatio > 0.5) strength += 1;
        
        // 強度レベルの決定
        let strengthClass, strengthMessage;
        
        if (strength <= 4) {
          strengthClass = 'weak';
          strengthMessage = '弱い';
        } else if (strength <= 6) {
          strengthClass = 'fair';
          strengthMessage = '普通';
        } else if (strength <= 8) {
          strengthClass = 'good';
          strengthMessage = '良い';
        } else {
          strengthClass = 'strong';
          strengthMessage = '強力';
        }
        
        // 表示を更新
        strengthText.textContent = strengthMessage;
        strengthText.className = 'strength-text ' + strengthClass;
        strengthBar.className = 'strength-bar-fill ' + strengthClass;
      }
      
      // パスワードをクリップボードにコピー
      function copyPassword() {
        passwordOutput.select();
        document.execCommand('copy');
        
        showCopyNotification();
      }
      
      // コピー通知を表示
      function showCopyNotification() {
        copyNotification.classList.add('show');
        
        setTimeout(() => {
          copyNotification.classList.remove('show');
        }, 3000);
      }
      
      // パスワード履歴に追加
      function addPasswordToHistory(password) {
        let history = getPasswordHistory();
        
        // 同じパスワードが既に存在する場合は追加しない
        if (history.includes(password)) return;
        
        // 履歴の上限（最新10件）
        const maxHistoryLength = 10;
        
        // 履歴が最大数を超えた場合、古いものから削除
        if (history.length >= maxHistoryLength) {
          history = history.slice(0, maxHistoryLength - 1);
        }
        
        // 新しいパスワードを先頭に追加
        history.unshift(password);
        
        // 履歴を保存
        localStorage.setItem('passwordHistory', JSON.stringify(history));
        
        // 表示を更新
        displayPasswordHistory();
      }
      
      // 保存されたパスワード履歴を取得
      function getPasswordHistory() {
        const historyJson = localStorage.getItem('passwordHistory');
        return historyJson ? JSON.parse(historyJson) : [];
      }
      
      // パスワード履歴を表示
      function loadPasswordHistory() {
        displayPasswordHistory();
      }
      
      // パスワード履歴を表示
      function displayPasswordHistory() {
        const history = getPasswordHistory();
        
        if (history.length === 0) {
          emptyHistory.style.display = 'block';
          historyList.innerHTML = '';
          historyList.appendChild(emptyHistory);
          return;
        }
        
        emptyHistory.style.display = 'none';
        historyList.innerHTML = '';
        
        history.forEach(password => {
          const historyItem = document.createElement('div');
          historyItem.className = 'history-item';
          
          const passwordText = document.createElement('div');
          passwordText.className = 'history-password';
          passwordText.textContent = password;
          
          const usePassword = document.createElement('span');
          usePassword.className = 'history-action';
          usePassword.textContent = '使用';
          usePassword.addEventListener('click', function() {
            passwordOutput.value = password;
            evaluatePasswordStrength(password);
          });
          
          historyItem.appendChild(passwordText);
          historyItem.appendChild(usePassword);
          historyList.appendChild(historyItem);
        });
      }
      
      // 履歴をクリア
      function clearHistory() {
        if (confirm('パスワード履歴をクリアしますか？')) {
          localStorage.removeItem('passwordHistory');
          displayPasswordHistory();
        }
      }
      
      // 連続した文字を避ける
      function avoidSequentialChars(password, charset) {
        const sequentialPatterns = [
          '123', '234', '345', '456', '567', '678', '789', '890',
          'abc', 'bcd', 'cde', 'def', 'efg', 'fgh', 'ghi', 'hij',
          'ijk', 'jkl', 'klm', 'lmn', 'mno', 'nop', 'opq', 'pqr',
          'qrs', 'rst', 'stu', 'tuv', 'uvw', 'vwx', 'wxy', 'xyz'
        ];
        
        let newPassword = password;
        
        sequentialPatterns.forEach(pattern => {
          if (newPassword.toLowerCase().includes(pattern)) {
            const index = newPassword.toLowerCase().indexOf(pattern);
            for (let i = 0; i < pattern.length; i++) {
              const randomChar = getRandomChar(charset);
              newPassword = replaceAt(newPassword, index + i, randomChar);
            }
          }
        });
        
        return newPassword;
      }
      
      // 繰り返される文字を避ける
      function avoidRepeatedChars(password, charset) {
        let newPassword = password;
        
        for (let i = 0; i < newPassword.length - 1; i++) {
          if (newPassword[i] === newPassword[i + 1]) {
            newPassword = replaceAt(newPassword, i + 1, getRandomChar(charset, newPassword[i]));
          }
        }
        
        return newPassword;
      }
      
      // 文字列の特定位置を別の文字に置き換える
      function replaceAt(string, index, replacement) {
        return string.substring(0, index) + replacement + string.substring(index + 1);
      }
      
      // ランダムな文字を取得（特定の文字を除外可能）
      function getRandomChar(charset, excludeChar = '') {
        let tempCharset = charset;
        
        // 除外する文字があれば削除
        if (excludeChar) {
          tempCharset = charset.replace(excludeChar, '');
        }
        
        // 文字セットが空でないことを確認
        if (tempCharset.length === 0) {
          return charset[Math.floor(Math.random() * charset.length)];
        }
        
        return tempCharset[Math.floor(Math.random() * tempCharset.length)];
      }
      
      // 初期設定
      updateLengthValue();
    });
  </script>
</body>
  <!-- フッター -->
  <div id="footer-placeholder"></div>
</body>
</html>
